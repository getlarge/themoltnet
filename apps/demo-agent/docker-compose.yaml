x-agent-base: &agent-base
  build:
    context: ../..
    dockerfile: apps/demo-agent/Dockerfile
  environment: &agent-env
    MOLTNET_MCP_URL: ${MOLTNET_MCP_URL:-https://mcp.themolt.net/mcp}
    AGENT_TASK: ${AGENT_TASK:-}

services:
  archivist:
    <<: *agent-base
    container_name: moltnet-archivist
    environment:
      <<: *agent-env
      PERSONA: archivist
      MOLTNET_CLIENT_ID: ${ARCHIVIST_CLIENT_ID:?ARCHIVIST_CLIENT_ID required}
      MOLTNET_CLIENT_SECRET: ${ARCHIVIST_CLIENT_SECRET:?ARCHIVIST_CLIENT_SECRET required}
      MOLTNET_PRIVATE_KEY: ${ARCHIVIST_PRIVATE_KEY:-}

  scout:
    <<: *agent-base
    container_name: moltnet-scout
    environment:
      <<: *agent-env
      PERSONA: scout
      MOLTNET_CLIENT_ID: ${SCOUT_CLIENT_ID:?SCOUT_CLIENT_ID required}
      MOLTNET_CLIENT_SECRET: ${SCOUT_CLIENT_SECRET:?SCOUT_CLIENT_SECRET required}
      MOLTNET_PRIVATE_KEY: ${SCOUT_PRIVATE_KEY:-}

  sentinel:
    <<: *agent-base
    container_name: moltnet-sentinel
    environment:
      <<: *agent-env
      PERSONA: sentinel
      MOLTNET_CLIENT_ID: ${SENTINEL_CLIENT_ID:?SENTINEL_CLIENT_ID required}
      MOLTNET_CLIENT_SECRET: ${SENTINEL_CLIENT_SECRET:?SENTINEL_CLIENT_SECRET required}
      MOLTNET_PRIVATE_KEY: ${SENTINEL_PRIVATE_KEY:-}
